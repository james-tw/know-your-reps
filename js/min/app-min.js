!function(){function e(e,t){e.when("/:stateId",{templateUrl:"rep-list.html",controller:"ListCtrl",controllerAs:"list"}).when("/rep/:repId",{templateUrl:"rep-detail.html",controller:"DetailCtrl",controllerAs:"detail"}).when("/",{templateUrl:"rep-list.html",controller:"ListCtrl",controllerAs:"list"}).otherwise({redirectTo:"/"})}function t(e){function t(e){var t={AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"};return t[e]}function r(t,r){e({method:"GET",url:"http://www.opensecrets.org/api/?method=getLegislators&output=json&id="+t+"&apikey="+i,cache:!0}).success(function(e){r(e)})}function n(t,r){e({method:"GET",url:"http://www.opensecrets.org/api/?method=candSummary&output=json&cid="+t+"&apikey="+i,cache:!0}).success(function(e){r(e)})}function a(t,r){e({method:"GET",url:"http://www.opensecrets.org/api/?method=candIndustry&output=json&cid="+t+"&apikey="+i,cache:!0}).success(function(e){r(e)})}var i="e083ad78821ccd23756c34c26b0713ff";return{getRepsByState:r,getRepSummary:n,getRepIndustry:a,getStateName:t}}function r(e){return{restrict:"EA",templateUrl:"rep-list.html",replace:!0,controllerAs:"list",controller:o}}function n(){return{restrict:"EA",templateUrl:"rep-panel.html",replace:!0,controllerAs:"panel",controller:s}}function a(){return{restrict:"EA",templateUrl:"rep-detail-industry.html",replace:!0,controllerAs:"industry",controller:l}}function i(){return{restrict:"EA",templateUrl:"map-widget.html",replace:!1,scope:{state:"="},link:function(e,t,r){$("#map").usmap({stateStyles:{fill:"#ADE5C0"},stateHoverStyles:{fill:"#FFC279"},stateHoverAnimation:180,click:function(t,r){e.state=r.name,e.$apply(),$("#map > svg > path").each(function(){$(this).css("fill","")}),$("#"+r.name).css("fill","#FFC279")}})},controller:function(e,t){t(function(){var t=e.stateId;t&&$("[data-hit="+t+"]").trigger("click")},1)}}}function o(e,t,r,n){function a(e){e&&n.getRepsByState(e,function(e){i.reps=e.response.legislator})}var i=this;e.state=t.stateId,i.query="",i.reps=[],i.stateName=n.getStateName(e.state),e.$watch("state",function(e){"undefined"!=typeof e&&(a(e),r.path("/"+e))})}function s(e){var t=this;t.parseOffice={getTitle:function(e){return"S"===e.charAt(2)?(t.rep=!1,"Sen."):(t.rep=!0,"Rep.")},getDistrict:function(e){return parseInt(e.slice(2,4),10)}}}function l(e){}function c(e,t,r){function n(e){var t=e.split(" ");if("Jr"==t[t.length-1]||"Sr"==t[t.length-1])var r=t.pop();return t=t.join(" ").split(",").reverse(),r&&t.push(r),t.join(" ")}function a(){var e=o.summary.chamber;return"H"===e?"Representative":"S"===e?"Senator":void 0}function i(){var e=o.summary.party;return"R"===e?"Republican":"D"===e?"Democrat":"Independent"}var o=this;o.repId=r.repId,o.hasDebt=!1,t.getRepSummary(o.repId,function(e){o.summary=e.response.summary["@attributes"],o.chamber=a(),o.party=i(),o.name=n(o.summary.cand_name),o.hasDebt=o.summary.debt>0?!0:!1}),t.getRepIndustry(o.repId,function(e){o.industries=e.response.industries.industry})}angular.module("congressApp",["ngRoute"]).directive("mapWidget",i).directive("repList",r).directive("repPanel",n).directive("repDetailIndustry",a).factory("openSecrets",t).controller("ListCtrl",["$scope","$routeParams","$location","openSecrets",o]).controller("DetailCtrl",["$scope","openSecrets","$routeParams",c]).config(e)}();