!function(){function t(t,e){t.when("/:stateId",{templateUrl:"rep-list.html",controller:"ListCtrl",controllerAs:"list"}).when("/rep/:repId",{templateUrl:"rep-detail.html",controller:"DetailCtrl",controllerAs:"detail"}).when("/",{templateUrl:"rep-list.html",controller:"ListCtrl",controllerAs:"list"}).otherwise({redirectTo:"/"})}function e(t){function e(t){return s[t]}function r(){return s}function n(e,r){t({method:"GET",url:"http://www.opensecrets.org/api/?method=getLegislators&output=json&id="+e+"&apikey="+o,cache:!0}).success(function(t){r(t)})}function a(e,r){t({method:"GET",url:"http://www.opensecrets.org/api/?method=candSummary&output=json&cid="+e+"&apikey="+o,cache:!0}).success(function(t){r(t)})}function i(e,r){t({method:"GET",url:"http://www.opensecrets.org/api/?method=candIndustry&output=json&cid="+e+"&apikey="+o,cache:!0}).success(function(t){r(t)})}var o="e083ad78821ccd23756c34c26b0713ff",s={AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"};return{getRepsByState:n,getRepSummary:a,getRepIndustry:i,getStateName:e,getStates:r}}function r(t){return{restrict:"EA",templateUrl:"rep-list.html",replace:!0,controllerAs:"list",controller:o}}function n(){return{restrict:"EA",templateUrl:"rep-panel.html",replace:!0,controllerAs:"panel",controller:s}}function a(){return{restrict:"EA",templateUrl:"rep-detail-industry.html",replace:!0,controllerAs:"industry",controller:c}}function i(t){return{restrict:"EA",templateUrl:"map-widget.html",replace:!1,scope:{state:"="},link:function(e,r,n){$("#map").usmap({stateStyles:{fill:"#ADE5C0"},stateHoverStyles:{fill:"#FFC279"},stateHoverAnimation:180,click:function(r,n){e.state=n.name,t(function(){e.$apply()}),$("#map > svg > path").each(function(){$(this).css("fill","")}),$("#"+n.name).css("fill","#FFC279")}})},controller:function(t,e,r){t.$watch("state",function(t){$("[data-hit="+t+"]").trigger("click")})}}}function o(t,e,r,n,a){function i(t){t&&a.getRepsByState(t,function(t){s.reps=t.response.legislator})}function o(){t.state=selectedState}var s=this;t.state=r.stateId,s.query="",s.reps=[],s.states=a.getStates(),t.$watch("state",function(e){"undefined"!=typeof e&&(s.stateName=a.getStateName(t.state),i(e),n.path("/"+e))});var c=e.current;t.$on("$locationChangeSuccess",function(t,r,a){-1===n.path().indexOf("rep")&&(e.current=c)})}function s(t){var e=this;e.parseOffice={getTitle:function(t){return"S"===t.charAt(2)?(e.rep=!1,"Sen."):(e.rep=!0,"Rep.")},getDistrict:function(t){return parseInt(t.slice(2,4),10)}}}function c(t){}function l(t,e,r){function n(t){var e=t.split(" ");if("Jr"===e[e.length-1]||"Sr"===e[e.length-1])var r=e.pop();return e=e.join(" ").split(",").reverse(),r&&e.push(r),e.join(" ")}function a(){var t=o.summary.chamber;return"H"===t?"Representative":"S"===t?"Senator":void 0}function i(){var t=o.summary.party;return"R"===t?"Republican":"D"===t?"Democrat":"Independent"}var o=this;o.repId=r.repId,o.hasDebt=!1,e.getRepSummary(o.repId,function(t){o.summary=t.response.summary["@attributes"],o.chamber=a(),o.party=i(),o.name=n(o.summary.cand_name),o.hasDebt=o.summary.debt>0?!0:!1}),e.getRepIndustry(o.repId,function(t){o.industries=t.response.industries.industry})}angular.module("congressApp",["ngRoute"]).directive("mapWidget",["$timeout",i]).directive("repList",r).directive("repPanel",n).directive("repDetailIndustry",a).factory("openSecrets",e).controller("ListCtrl",["$scope","$route","$routeParams","$location","openSecrets",o]).controller("DetailCtrl",["$scope","openSecrets","$routeParams",l]).config(t)}();